let routingEnabled=!1;const routeChangeCallbacks=[];export const onRouteChange=(a)=>{routingEnabled||(window.addEventListener('hashchange',notifyRouteChange),window.addEventListener('location-changed',notifyRouteChange),window.addEventListener('popstate',notifyRouteChange),document.body.addEventListener('click',globalClickHandler),routingEnabled=!0),routeChangeCallbacks.push(a)};const globalClickHandler=(a)=>{if(!a.defaultPrevented){const b=getSameOriginLinkHref(a);b&&(a.preventDefault(),b===window.location.href||(window.history.pushState({},'',b),window.dispatchEvent(new Event('location-changed'))))}},getSameOriginLinkHref=(a)=>{if(0!==a.button)return null;if(a.metaKey||a.ctrlKey)return null;const b=a.path||a.composedPath&&a.composedPath();let c=null;for(var d,e=0;e<b.length;e++)if(d=b[e],'A'===d.tagName&&d.href){c=d;break}if(!c)return null;if('_blank'===c.target)return null;if(('_top'===c.target||'_parent'===c.target)&&window.top!==window)return null;const f=c.href,g=resolveURL(f,document.baseURI);let h;if(h=g.origin?g.origin:g.protocol+'//'+g.host,h!==window.location.origin)return null;let i=g.pathname+g.search+g.hash;return'/'!==i[0]&&(i='/'+i),resolveURL(i,window.location.href).href},notifyRouteChange=()=>{routeChangeCallbacks.forEach((a)=>a(currentPath(),currentQuery(),currentHash()))};export const currentPath=()=>window.decodeURIComponent(window.location.pathname);export const currentQuery=()=>window.location.search.slice(1);export const currentHash=()=>window.decodeURIComponent(window.location.hash.slice(1));let workingURL,resolveDoc;export const resolveURL=(a,b)=>{if(null===b&&(b=void 0),void 0==workingURL){workingURL=!1;try{const a=new URL('b','http://a');a.pathname='c%20d',workingURL='http://a/c%20d'===a.href,workingURL=workingURL&&'http://a/?b%20c'===new URL('http://a/?b c').href}catch(a){}}return workingURL?new URL(a,b):(resolveDoc||(resolveDoc=document.implementation.createHTMLDocument('temp'),resolveDoc.base=resolveDoc.createElement('base'),resolveDoc.head.appendChild(resolveDoc.base),resolveDoc.anchor=resolveDoc.createElement('a')),resolveDoc.base.href=b,resolveDoc.anchor.href=a,resolveDoc.anchor)};
//# sourceMappingURL=gluon-router.js.map
